<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guide Manager</title>
  <style>
    :root {
      --figma-color-text: #333333;
      --figma-color-accent: #7B61FF;
    }

    html,
    body {
      background-color: var(--figma-color-bg);
      box-sizing: border-box;
      color: var(--figma-color-text);
      font-family: Inter, sans-serif;
      font-size: 16px;
      margin: 0;
      max-height: 100%;
      max-width: 100%;
      padding: 0;
    }

    .container {
      margin: 0 auto;
      padding: 0;
      width: 15rem;
      display: flex;
      flex-direction: column;
    }

    .col-4 {
      width: 14rem;
    }

    input:focus {
      outline: none;
    }

    .input-large {
      font-size: 2rem;
      height: 3rem;
      font-weight: bold;
    }

    .border-bottom {
      border: 0;
      border-bottom: 1px solid lightgray;
    }

    .text-center {
      text-align: center;
    }

    .width-auto {
      width: auto;
    }

    .width-100 {
      width: 240px;
    }

    .mx-auto {
      margin: 0 auto;
    }

    .mb-16 {
      margin-bottom: 16px;
    }

    .mb-32 {
      margin-bottom: 32px;
    }

    .spacer-32 {
      height: 2rem;
    }

    .row {
      margin-bottom: 1rem;
      ;
    }

    .flex-4 {
      column-gap: 1rem;
      display: flex;
      flex-direction: row;
      margin: 0;
    }

    .btn {
      background-color: white;
      border-radius: .5rem;
      border: 1px solid lightgray;
      cursor: pointer;
      font-size: 1rem;
      font-weight: bold;
      margin: 0;
    }

    .btn:hover {
      border-color: var(--figma-color-accent);
      color: var(--figma-color-accent);
    }

    .btn:hover svg path,
    .btn:hover svg line {
      fill: var(--figma-color-accent);
      stroke: var(--figma-color-accent);
    }

    .btn-icon {
      width: 3rem;
      height: 3rem;
      padding: .5rem;
    }

    .btn-icon svg {
      width: 2rem;
      height: 2rem;
    }

    .btn-icon span {
      display: flex;
      width: 2rem;
      justify-content: center;
      align-items: center;
    }

    footer {
      display: flex;
      justify-content: space-between;
      font-size: .7rem;
      background-color: #333333;
      color: white;
      min-height: 2rem;
      margin-top: 16px;
    }

    footer .container {
      margin: 0 .8rem;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      width: 100%;

    }

    footer a {
      color: white;
      text-decoration: none;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="spacer-32"></div>
    <div class="row">
      <input type="text" value="0" id="guideValue" class="input input-large border-bottom text-center col-4 mb-16"
        placeholder="00" />
    </div>

    <div class="row">
      <div class="col-4 mx-auto flex-4">
        <button class="btn btn-icon" data-action="clearAllGuides">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="currentColor">
            <line y1="24.5" x2="32" y2="24.5" stroke="#D9D9D9" stroke-width="3" />
            <line y1="15.5" x2="32" y2="15.5" stroke="#D9D9D9" stroke-width="3" />
            <line y1="7.5" x2="32" y2="7.5" stroke="#D9D9D9" stroke-width="3" />
            <path
              d="M0.671367 0.671367C0.883644 0.458553 1.13582 0.289707 1.41345 0.174503C1.69108 0.0592985 1.98872 0 2.2893 0C2.58989 0 2.88752 0.0592985 3.16515 0.174503C3.44278 0.289707 3.69496 0.458553 3.90723 0.671367L16.0006 12.7693L28.094 0.671367C28.3064 0.458897 28.5587 0.290356 28.8363 0.175368C29.1139 0.0603802 29.4114 0.00119646 29.7119 0.00119646C30.0124 0.00119646 30.3099 0.0603802 30.5875 0.175368C30.8651 0.290356 31.1174 0.458897 31.3298 0.671367C31.5423 0.883837 31.7108 1.13608 31.8258 1.41368C31.9408 1.69129 32 1.98882 32 2.2893C32 2.58978 31.9408 2.88732 31.8258 3.16492C31.7108 3.44253 31.5423 3.69476 31.3298 3.90723L19.2319 16.0006L31.3298 28.094C31.5423 28.3064 31.7108 28.5587 31.8258 28.8363C31.9408 29.1139 32 29.4114 32 29.7119C32 30.0124 31.9408 30.3099 31.8258 30.5875C31.7108 30.8651 31.5423 31.1174 31.3298 31.3298C31.1174 31.5423 30.8651 31.7108 30.5875 31.8258C30.3099 31.9408 30.0124 32 29.7119 32C29.4114 32 29.1139 31.9408 28.8363 31.8258C28.5587 31.7108 28.3064 31.5423 28.094 31.3298L16.0006 19.2319L3.90723 31.3298C3.69476 31.5423 3.44253 31.7108 3.16492 31.8258C2.88732 31.9408 2.58978 32 2.2893 32C1.98882 32 1.69129 31.9408 1.41368 31.8258C1.13608 31.7108 0.883837 31.5423 0.671367 31.3298C0.458897 31.1174 0.290356 30.8651 0.175368 30.5875C0.0603802 30.3099 0.00119646 30.0124 0.00119646 29.7119C0.00119646 29.4114 0.0603802 29.1139 0.175368 28.8363C0.290356 28.5587 0.458897 28.3064 0.671367 28.094L12.7693 16.0006L0.671367 3.90723C0.458553 3.69496 0.289707 3.44278 0.174503 3.16515C0.0592985 2.88752 0 2.58989 0 2.2893C0 1.98872 0.0592985 1.69108 0.174503 1.41345C0.289707 1.13582 0.458553 0.883644 0.671367 0.671367Z"
              fill="#333333" />
          </svg>
        </button>

        <button class="btn btn-icon" data-action="addMargin">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <line x1="24.5" y1="6.55671e-08" x2="24.5" y2="32" stroke="#333333" stroke-width="3" />
            <line x1="8.5" y1="6.55671e-08" x2="8.5" y2="32" stroke="#333333" stroke-width="3" />
            <line y1="24.5" x2="32" y2="24.5" stroke="#333333" stroke-width="3" />
            <line y1="7.5" x2="32" y2="7.5" stroke="#333333" stroke-width="3" />
          </svg>

        </button>

        <button class="btn btn-icon" data-action="addX">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="currentColor">
            <path
              d="M16 0C7.16373 0 0 7.16373 0 16C0 24.8363 7.16373 32 16 32C24.8363 32 32 24.8363 32 16C32 7.16373 24.8363 0 16 0ZM18.9403 23.7376L15.9995 18.4608L12.8928 23.7376H9.13387L14.1104 15.8533L9.37547 8.26293H13.2389L15.9989 13.3024L18.8347 8.26293H22.5723L17.8373 15.7275L22.8661 23.7381H18.9403V23.7376Z"
              fill="#333333" />
          </svg>
        </button>

        <button class="btn btn-icon" data-action="addY">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
            <path
              d="M16 0C7.16373 0 0 7.16373 0 16C0 24.8363 7.16373 32 16 32C24.8363 32 32 24.8363 32 16C32 7.16373 24.8363 0 16 0ZM17.7056 17.9344V23.7376H14.472V17.9344L9.11787 8.2624H12.9291L16.1413 15.0021L19.2181 8.2624H22.8821L17.7056 17.9344Z"
              fill="#333333" />
          </svg>
        </button>
      </div>
    </div>
    <div class="row">
      <div class="col-4 mx-auto flex-4">
        <button class="btn btn-icon" data-action="subtract4px"><span>-4</span></button>
        <button class="btn btn-icon" data-action="add4px"><span>+4</span></button>
        <button class="btn btn-icon" data-action="multiplyBy038"><span>*.38</span></button>
        <button class="btn btn-icon" data-action="multiplyBy062"><span>*.62</span></button>
      </div>
    </div>
    <div class="row">
      <div class="col-4 mx-auto flex-4">
        <button class="btn btn-icon" data-action="getFrameWidth">
          <svg width="34" height="16" viewBox="0 0 34 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M33 8.00001H1M33 8.00001L26.6 14.4M33 8.00001L26.6 1.60001M1 8.00001L7.4 14.4M1 8.00001L7.4 1.60001"
              stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>

        <button class="btn btn-icon" data-action="getFrameHeight">
          <svg width="16" height="34" viewBox="0 0 16 34" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M8.00001 1L14.4 7.4M8.00001 33V1V33ZM8.00001 33L1.60001 26.6L8.00001 33ZM8.00001 33L14.4 26.6L8.00001 33ZM8.00001 1L1.60001 7.4L8.00001 1Z"
              stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>

        </button>
      </div>
    </div>
  </div>
  <footer>
    <div class="container">
      <div><a href='www.wildiney.com'>www.wildiney.com</a></div>
      <div>v.2.0.0</div>
    </div>
  </footer>

  <script>
    const input = document.getElementById('guideValue');
    const btnClearAllGuides = document.querySelector('[data-action="clearAllGuides"]');
    const btnAddMargin = document.querySelector('[data-action="addMargin"]');
    const btnAddX = document.querySelector('[data-action="addX"]');
    const btnAddY = document.querySelector('[data-action="addY"]');
    const btnAdd4 = document.querySelector('[data-action="add4px"]');
    const btnSubtract4px = document.querySelector('[data-action="subtract4px"]');
    const btnMultiplyBy038 = document.querySelector('[data-action="multiplyBy038"]');
    const btnMultiplyBy062 = document.querySelector('[data-action="multiplyBy062"]');
    const btnGetFrameWidth = document.querySelector('[data-action="getFrameWidth"]');
    const btnGetFrameHeight = document.querySelector('[data-action="getFrameHeight"]');

    function calculate (id, value) {
      const newValue = eval(value)
      return newValue
    }

    function processValue () {
      let element = document.getElementById('guideValue');
      const value = parseInt(eval(element.value));
      if (value >= 0) {
        element.value = value;
      }
      return value
    }

    btnAddMargin.addEventListener('click', () => {
      console.log('addMargin');
      const element = document.getElementById('guideValue')
      if (element === null) return
      const value = element.value;
      parent.postMessage({
        pluginMessage: {
          type: 'add-margins',
          data: { marginSize: value }
        }
      }, '*');
    })

    btnAddX.addEventListener('click', () => {
      console.log('addX');
      const element = document.getElementById('guideValue')
      if (element === null) return
      let value = element.value;
      console.log(value)
      value = processValue(value);
      parent.postMessage({
        pluginMessage: {
          type: 'add-guides', data: { axis: 'Y', offset: value }
        }
      }, '*');
    });

    btnAddY.addEventListener('click', () => {
      console.log('addY');
      const element = document.getElementById('guideValue')
      if (element === null) return
      let value = element.value;
      console.log(value)
      value = processValue();
      parent.postMessage({
        pluginMessage: {
          type: 'add-guides', data: { axis: 'X', offset: value }
        }
      }, '*');
    });

    btnAdd4.addEventListener('click', () => {
      console.log('add4');
      let element = document.getElementById('guideValue');
      let value = parseInt(element.value) + 4;
      if (value < 0) {
        value = 0
      }
      element.value = value;
      return value
    });

    btnSubtract4px.addEventListener('click', () => {
      console.log('add4');
      let element = document.getElementById('guideValue');
      let value = parseInt(element.value) - 4;
      if (value < 0) {
        value = 0
      }
      element.value = value;
      return value
    });

    btnMultiplyBy038.addEventListener('click', () => {
      console.log('multiply by 0.38');
      let element = document.getElementById('guideValue');
      let value = parseInt(element.value) * .38;
      if (value < 0) {
        value = 0
      }
      element.value = value;
      return value
    });

    btnMultiplyBy062.addEventListener('click', () => {
      console.log('multiply by 0.62');
      let element = document.getElementById('guideValue');
      let value = parseInt(element.value) * .62;
      if (value < 0) {
        value = 0
      }
      element.value = value;
      return value
    });

    btnGetFrameWidth.addEventListener('click', () => {
      console.log('frame width');
      parent.postMessage({ pluginMessage: { type: 'frameWidth' } }, '*');
    });

    btnGetFrameHeight.addEventListener('click', () => {
      console.log('frame height');
      parent.postMessage({ pluginMessage: { type: 'frameHeight' } }, '*');
    });

    btnClearAllGuides.addEventListener('click', () => {
      console.log('clear all guides');
      parent.postMessage({ pluginMessage: { type: 'clearAllGuides' } }, '*');
    });

    onmessage = (event) => {
      console.log(event)
      let message = event.data.pluginMessage;
      console.log(message)

      if (message.query === 'inputValue') {
        input.value = message.results;
      }
    }
  </script>
</body>

</html>